%!TeX program = lualatex
\documentclass{beamer}
\usepackage{forest} % Vẽ cây
\usepackage{polyglossia} 
\setdefaultlanguage{vietnamese}
\setotherlanguage{english}
\usepackage{import}
\usepackage[ruled,vlined]{algorithm2e}
\usepackage{tabularray}

\usetikzlibrary{arrows.meta,matrix,positioning}


\usepackage[skip=6pt]{caption}  % trong preamble
\captionsetup[table]{position=above}

\ExplSyntaxOn

\NewDocumentEnvironment{twotrees}{mmmm}
 {
   % Split note by "/" into two parts
   \seq_set_split:Nnn \l_tmpa_seq {/} {#4}
   \seq_pop_left:NN \l_tmpa_seq \l_phu_note_left_tl
   \seq_pop_left:NN \l_tmpa_seq \l_phu_note_right_tl

   \begin{tikzpicture}[>=Stealth]

	% Left tree
	% Nên thêm anchor=north west (hoặc north) để dễ kiểm soát toạ độ gốc (0,0) là góc trên
	\node[rectangle, draw, anchor=north\space west] (lefttree) at (0, 0) {#1};
	
	% Right tree
	% SỬA:
	% 1. `of lefttree.north east`: Đặt vị trí dựa trên góc TRÊN-PHẢI của cây trái.
	% 2. `anchor=north west`: Neo góc TRÊN-TRÁI của cây phải vào vị trí đó.
	\node[rectangle, draw, right=#3\space of\space lefttree.north\space east, anchor=north\space west] (righttree) {#2};

     % Draw arrow(s)
     \tl_if_blank:VTF \l_phu_note_right_tl
       {
         %---- Only one note =>  left -> right
         \draw[->, thick, cyan, text=black]
           (lefttree.east) -- node[below]{\l_phu_note_left_tl} ($(lefttree.east)+(#3,0)$);
       }
       {
         %---- Two notes =>  two arrows
         % Lower arrow: left -> right
         \draw[->, thick, cyan, text=black]
           ($(lefttree.east)+(0,0.1cm)$) -- node[above,text=black]{\l_phu_note_left_tl} ($(lefttree.east)+(#3,0.1cm)$);

         % Upper arrow: right -> left
         \draw[<-, thick, yshift=6pt, cyan, text=black]
           ($(lefttree.east)-(0,0.1cm)$) -- node[below]{\l_phu_note_right_tl} ($(lefttree.east)+(#3,-0.1cm)$);
       }
 }
 {
   \end{tikzpicture}
 }

\ExplSyntaxOff

\ExplSyntaxOn

% Khai báo biến tạm để chứa text label
\tl_new:N \l_label_one_tl
\tl_new:N \l_label_two_tl

\NewDocumentEnvironment{threetrees}{mmmmm}
 {
   % #1: Code Cây 1 (Trái)
   % #2: Code Cây 2 (Giữa)
   % #3: Code Cây 3 (Phải)
   % #4: Khoảng cách giữa các cây (Distance)
   % #5: Label cho mũi tên (Dạng: "Text 1 / Text 2")

   % 1. Tách chuỗi #5 bằng dấu "/"
   \seq_set_split:Nnn \l_tmpa_seq {/} {#5}
   
   % Lấy label đầu tiên cho mũi tên 1
   \seq_pop_left:NN \l_tmpa_seq \l_label_one_tl
   
   % Lấy label thứ hai (nếu có) cho mũi tên 2, nếu không có thì để trống
   \seq_if_empty:NTF \l_tmpa_seq
     { \tl_clear:N \l_label_two_tl }
     { \seq_pop_left:NN \l_tmpa_seq \l_label_two_tl }

   \begin{tikzpicture}[>=Stealth]

   % --- VẼ 3 CÂY ---
   
   % Cây 1: Gốc tại (0,0)
   \node[rectangle, draw, anchor=north~west] (treeOne) at (0, 0) {#1};
   
   % Cây 2: Nằm bên phải Cây 1
   \node[rectangle, draw, right=#4~of~treeOne.north~east, anchor=north~west] (treeTwo) {#2};
   
   % Cây 3: Nằm bên phải Cây 2
   \node[rectangle, draw, right=#4~of~treeTwo.north~east, anchor=north~west] (treeThree) {#3};

   % --- VẼ MŨI TÊN ---
   
   % Mũi tên 1: Từ Cây 1 -> Cây 2
   \draw[->, thick, cyan, text=black]
     (treeOne.east) -- node[above=2pt] {\l_label_one_tl} ($(treeOne.east)+(#4,0)$);

   % Mũi tên 2: Từ Cây 2 -> Cây 3
   \draw[->, thick, cyan, text=black]
     (treeTwo.east) -- node[above=2pt] {\l_label_two_tl} ($(treeTwo.east)+(#4,0)$);

 }
 {
   \end{tikzpicture}
 }

\ExplSyntaxOff

\forestset{
  node/.style={font={\scriptsize},circle,draw=black,minimum size=1.2em,inner sep=1pt,fill=none,text=black},
  black-node/.style={fill=black,text=white},
  nil-node/.style={rectangle,content={}, minimum size=5pt},
  red-node/.style={node,text=white,draw=red!70!black,fill=red!80!black},
  non-decorate-node/.style={node,draw=none,fill=none,shape=rectangle,text=black},
  tree/.style={for tree={node}},
  rb-tree/.style={tree,for tree={black-node}},
  empty-node/.style={non-decorate-node, minimum size=0pt, inner sep=1pt,content={}},
  rand-node/.style={node,text=white,fill=brown!90!black,draw=brown!70!black},
}


% Title setup
\title{Cây nhị phân tìm kiếm cân bằng}
\subtitle{Cây AVL và Cây Đỏ-đen}
\author{Huỳnh Thiên An -- 23120001\and Hoàng Ngọc Phú -- 23120010\and Hoàng Ngọc Quí -- 23120077\and Nguyễn Duy Bảo -- 23120113}
\institute{Giảng viên: Thầy Nguyễn Hải Đăng}
\date{Thứ ba, ngày 2 tháng 12 năm 2025}

% Beamer setup
% Gói cần thiết
\usetheme{default} % theme cơ bản, bạn có thể đổi theme khác nếu muốn

% ---------------------------
% Header: chỉ hiện section/subsection
% ---------------------------
\setbeamertemplate{headline}{%
  \begin{beamercolorbox}[wd=\paperwidth,ht=2.5ex,dp=1ex,leftskip=1em,rightskip=1em]{section in head/foot}
    \insertsectionhead%
    \ifx\insertsubsectionhead\empty
    \else
      ~|~\insertsubsectionhead
    \fi
    \hfill\insertframenumber
  \end{beamercolorbox}%
}

% ---------------------------
% Footer: chỉ hiện số trang
% ---------------------------
%\setbeamertemplate{footline}{%
%  \begin{beamercolorbox}[wd=\paperwidth,ht=2.5ex,dp=1ex,leftskip=1em,rightskip=1em]{page number in head/foot}
%    
%  \end{beamercolorbox}%
% }


% ---------------------------
% Loại bỏ navigation symbols (nút điều hướng)
% ---------------------------
\setbeamertemplate{navigation symbols}{}
\AtBeginSection[]{
    \begin{frame}{Mục lục}
        \tableofcontents[currentsection]
    \end{frame}
}

\usecolortheme{seahorse}
%\usecolortheme{rose}
\begin{document}

\begin{frame}[plain]
\titlepage
\end{frame}


\begin{frame}
\frametitle{Mục lục}
\tableofcontents
\end{frame}

\import{}{bao.tex}
\import{}{qui.tex}
\import{}{phu.tex}
\import{}{an.tex}

\end{document}